<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XP Calculator</title>
<link href="style_website.css" rel="stylesheet" type="text/css" media="all">
</head>
<body>
<p><a href="index.html"><img src="flame_dimetap.gif"></a></p>
<ul>
  <li><a href="index.html">Home</a></li>
  <li><a href="Rules_JASCI.html">JASCI TRPG Rules</a></li>
  <li><a href="Combat_Roller.html">Combat Roller</a></li>
  <li><a href="XP_Calculator.html">XP Calculator</a></li>
  <li><a href="monsters_and_men.html">Monsters and Men</a></li>
</ul>
<img src="calculator.gif">
<h1>JASCI XP Calculator</h1>

<div class="grid-2">

    <!-- Combat XP Panel -->
    <div class="panel">
        <h2>Combat XP Calculator</h2>
        <form id="combatXpForm" class="form-grid">
            <label for="numberOfEnemies">Number of Enemies:
                <input type="number" id="numberOfEnemies" value="1">
            </label>
            <label for="enemyCR">Enemy Challenge Rating:
                <input type="number" id="enemyCR" step="0.1" value="1">
            </label>
            <label for="characterLevels">Character Levels (comma-separated):
                <input type="text" id="characterLevels" value="" placeholder="e.g. 1, 2, 1">
            </label>
            <label for="numberOfCharacters">Number of Characters:
                <input type="number" id="numberOfCharacters" value="1">
            </label>
            <button type="button" onclick="calculateCombatXP()">Calculate Combat XP</button>
        </form>
        <div id="combatXP" class="result-display">Combat XP: 0</div>
    </div>

    <!-- Out of Combat XP Panel -->
    <div class="panel">
        <h2>Out of Combat XP Calculator</h2>
        <form id="xpForm" class="form-grid">
            <label for="easyInstances">Easy Instances (10xp):
                <input type="number" id="easyInstances" value="0">
            </label>
            <label for="mediumInstances">Medium Instances (25xp):
                <input type="number" id="mediumInstances" value="0">
            </label>
            <label for="hardInstances">Hard Instances (75xp):
                <input type="number" id="hardInstances" value="0">
            </label>
            <label for="miscInstances">Miscellaneous Instances:
                <input type="number" id="miscInstances" value="0">
            </label>
            <button type="button" onclick="calculateXP()">Calculate XP</button>
        </form>
        <div id="totalXP" class="result-display">Total XP: 0</div>
    </div>

</div>

<script>
function calculateCombatXP() {
    const numberOfEnemies = parseInt(document.getElementById('numberOfEnemies').value) || 0;
    const enemyCR = parseFloat(document.getElementById('enemyCR').value) || 0;
    const characterLevelsInput = document.getElementById('characterLevels').value.split(',');
    const characterLevels = characterLevelsInput.map(level => parseFloat(level)).filter(level => !Number.isNaN(level));
    const numberOfCharacters = parseInt(document.getElementById('numberOfCharacters').value) || 0;

    const crSum = Math.round((numberOfEnemies > 1 ? numberOfEnemies * 1.5 : numberOfEnemies) * enemyCR);
    const maxCrSum = Math.max(crSum, 0); // Ensuring non-negative
    const averageCharacterLevel = characterLevels.length > 0 ? characterLevels.reduce((a, b) => a + b, 0) / characterLevels.length : 0;

    const xp = Math.round((3.96 * Math.pow(crSum, 2) + (maxCrSum < 1 ? 25 : 100)) * (maxCrSum > averageCharacterLevel + 8 ? 1.5 : (maxCrSum > averageCharacterLevel + 3 ? 1.25 : 1)) / numberOfCharacters);
    document.getElementById('combatXP').innerHTML = 'Combat XP to Award Individually: <br><span style="color: #ffff55; font-size: 2rem;">' + xp + '</span>';
}

function calculateXP() {
    const easy = parseInt(document.getElementById('easyInstances').value) * 10 || 0;
    const medium = parseInt(document.getElementById('mediumInstances').value) * 25 || 0;;
    const hard = parseInt(document.getElementById('hardInstances').value) * 75 || 0;
    const misc = parseInt(document.getElementById('miscInstances').value) || 0;

    const totalXP = easy + medium + hard + misc;
    document.getElementById('totalXP').innerHTML = 'Total XP: <br><span style="color: #ffff55; font-size: 2rem;">' + totalXP + '</span>';
}
</script>
</body>
</html>
