{
  "quests": {
    "goblin_ears_bounty": {
      "id": "goblin_ears_bounty",
      "title": "Goblin Ears Bounty",
      "description": "The town guard has issued a bounty for goblin ears to curb their recent raids. Collect 10 goblin ears.",
      "type": "Bounty",
      "giverNpcId": "guard_captain_aelric",
      "startConditions": [
        { "type": "flagNotSet", "flag": "goblin_bounty_completed_creek_ครั้ง1" }
      ],
      "objectives": [
        {
          "id": "collect_ears",
          "description": "Collect 10 Goblin Ears.",
          "type": "collect",
          "target": {
            "npcTypeId": "goblin_scout",
            "count": 10,
            "itemDropped": "goblin_ear"
          },
          "itemToCollect": { "itemId": "goblin_ear", "count": 10 },
          "progressText": "Goblin Ears Collected: {currentCount}/{targetCount}",
          "locationHint": "Shadowy Woods, near the old ruins."
        },
        {
          "id": "return_to_aelric",
          "description": "Return to Guard Captain Aelric with the ears.",
          "type": "talk_to_npc",
          "targetNpcId": "guard_captain_aelric",
          "locationHint": "Beginner's Creek, Town Hall or Barracks.",
          "onCompletionActions": [
            { "type": "adjustFactionRep", "factionId": "starter_town_guard", "amount": 5, "note": "Bonus rep for this specific objective step" }
          ]
        }
      ],
      "rewards": [
        { "type": "experience", "amount": 150 },
        { "type": "currency", "currencyId": "gold_coins", "amount": 50 },
        { "type": "item", "itemId": "potion_health_minor", "quantity": 2 }
      ],
      "onCompletionActions": [
        { "type": "setFlag", "flag": "goblin_bounty_completed_creek_ครั้ง1", "value": true },
        { "type": "adjustFactionRep", "factionId": "starter_town_guard", "amount": 10 }
      ],
      "isRepeatable": false
    },
    "lost_locket_retrieve": {
      "id": "lost_locket_retrieve",
      "title": "The Lost Locket",
      "description": "Old Man Hemlock has lost a precious locket, a memento of his late wife. He believes he dropped it while foraging in the Shadowy Woods.",
      "type": "Retrieval",
      "giverNpcId": "old_man_hemlock",
      "startConditions": [
        { "type": "questCompleted", "questId": "hypothetical_tutorial_quest" },
        { "type": "flagSet", "flag": "met_hemlock" }
      ],
      "objectives": [
        {
          "id": "find_locket_location",
          "description": "Search for the locket in the area Hemlock described.",
          "type": "reach_location",
          "targetLocation": {
            "mapId": "maps/forest_clearing.json",
            "coordinates": {"x": 10, "y": 12},
            "radius": 5
          },
          "locationHint": "A small clearing in the Shadowy Woods, west of the main path, where Hemlock often picks berries."
        },
        {
          "id": "find_locket_item",
          "description": "Find Hemlock's Locket.",
          "type": "fetch",
          "targetItem": { "itemId": "hemlock_locket_unique" },
          "progressText": "Locket Found: {hasItem}",
          "locationHint": "It might be near a distinctive old oak tree in that clearing."
        },
        {
          "id": "return_locket_to_hemlock",
          "description": "Return the locket to Old Man Hemlock.",
          "type": "talk_to_npc",
          "targetNpcId": "old_man_hemlock",
          "locationHint": "His shack on the outskirts of Beginner's Creek."
        }
      ],
      "rewards": [
        { "type": "experience", "amount": 200 },
        { "type": "item", "itemId": "heirloom_ring_returnedfavor", "quantity": 1 },
        { "type": "factionReputation", "factionId": "creek_villagers", "amount": 15 }
      ],
      "onCompletionActions": [
        { "type": "setFlag", "flag": "hemlock_locket_returned", "value": true },
        { "type": "startQuest", "questId": "hemlock_followup_herb_gathering", "ifCondition": { "type": "playerChoice", "choiceIdMade": "dialogue_option_ask_about_herbs" } }
      ],
      "failureConditions": [
        { "type": "timer", "durationDays": 7, "onFailMessage": "Too much time has passed, the locket is likely lost forever." },
        { "type": "npcStatus", "npcId": "old_man_hemlock", "status": "dead", "onFailMessage": "Old Man Hemlock has passed away." }
      ]
    },
    "spy_investigation": {
      "id": "spy_investigation",
      "title": "Unmask the Spy",
      "description": "Guard Captain Aelric suspects a spy is operating in Beginner's Creek, feeding information to bandits in the woods. Investigate and identify the culprit.",
      "type": "Investigation",
      "giverNpcId": "guard_captain_aelric",
      "startConditions": [
        { "type": "flagSet", "flag": "goblin_threat_reduced_creek" }
      ],
      "objectives": [
        {
          "id": "gather_clues_townsfolk",
          "description": "Subtly ask around town for any suspicious activities or strangers.",
          "type": "talk_to_multiple_npcs",
          "targetNpcs": [
            { "npcId": "innkeeper_boris", "dialogueBranch": "spy_rumors" },
            { "npcId": "merchant_silas", "dialogueBranch": "unusual_purchases" },
            { "npcId": "farmer_gertrude", "dialogueBranch": "strange_sightings" }
          ],
          "minRequired": 2,
          "progressText": "Clues Gathered: {currentCount}/{targetCount}",
          "locationHint": "The Inn, General Store, and the fields are good places to start."
        },
        {
          "id": "observe_suspect_x",
          "description": "Based on clues, you suspect [Suspect X]. Observe their nightly activities.",
          "type": "observe",
          "targetNpcId": "dynamic_suspect_id",
          "timeOfDay": "night",
          "locationHint": "[Suspect X]'s home or usual nightly spot.",
          "triggerCondition": { "flag": "identified_suspect_x" }
        },
        {
          "id": "find_incriminating_letter",
          "description": "Search [Suspect X]'s belongings or drop-off point for evidence.",
          "type": "fetch",
          "targetItem": { "itemId": "incriminating_letter_spy" },
          "locationHint": "A loose floorboard in [Suspect X]'s house, or a hollow tree stump near the woods.",
          "triggerCondition": { "flag": "observed_suspect_x_behavior" }
        },
        {
          "id": "confront_spy",
          "description": "Confront [Suspect X] with the evidence.",
          "type": "talk_to_npc",
          "targetNpcId": "dynamic_suspect_id",
          "dialogueBranch": "spy_confrontation",
          "locationHint": "[Suspect X]'s current location.",
          "triggerCondition": { "flag": "found_incriminating_letter" }
        },
        {
          "id": "report_to_aelric",
          "description": "Report your findings (and the spy, if dealt with) to Guard Captain Aelric.",
          "type": "talk_to_npc",
          "targetNpcId": "guard_captain_aelric",
          "locationHint": "Town Hall or Barracks."
        }
      ],
      "rewards": [
        { "type": "experience", "amount": 500 },
        { "type": "currency", "currencyId": "gold_coins", "amount": 200 },
        { "type": "item", "itemId": "guard_commendation_creek", "quantity": 1 }
      ],
      "onCompletionActions": [
        { "type": "setFlag", "flag": "creek_spy_unmasked", "value": true },
        { "type": "removeNpc", "npcId": "dynamic_suspect_id", "ifFlag": "spy_arrested" },
        { "type": "spawnNpc", "npcId": "new_recruit_guard", "location": "maps/barracks.json", "ifFlag": "spy_was_guard_recruit" },
        { "type": "startQuest", "questId": "new_threat_emerges_plot", "ifCondition": { "type": "flagSet", "flag": "spy_report_implicates_higher_ups" } }
      ],
      "branches": {
        "peaceful_resolution": {
          "condition": { "flag": "spy_convinced_to_surrender" },
          "rewards_override": [ { "type": "experience", "amount": 600 } ]
        },
        "violent_resolution": {
          "condition": { "flag": "spy_killed_in_confrontation" },
          "rewards_override": [ { "type": "experience", "amount": 400 } ]
        }
      }
    }
  }
}
