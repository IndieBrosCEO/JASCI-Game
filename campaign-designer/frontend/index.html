<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campaign Designer</title>
    <link rel="stylesheet" href="campaign-designer-theme.css">
</head>
<body>
    <h1>Campaign Designer</h1>

    <div id="manifestDetailsSection">
        <h2>Campaign Manifest</h2>
        <div id="manifestControls">
            <button id="loadManifestButton">Load Campaign Manifest</button>
            <input type="file" id="fileUploader" accept=".json,.zip" multiple style="display: block; margin-top: 10px;">
            <button id="saveManifestButton" class="button-primary">Save Campaign Manifest</button>
            <button id="exportCampaignButton" class="button-primary" style="margin-left: 10px;">Export Campaign to ZIP</button>
        </div>
        <div><label for="campaignId">ID:</label><input type="text" id="campaignId" readonly></div>
        <div><label for="campaignName">Name:</label><input type="text" id="campaignName" readonly></div>
        <div><label for="campaignVersion">Version:</label><input type="text" id="campaignVersion" readonly></div>
        <div><label for="campaignDescription">Description:</label><textarea id="campaignDescription" rows="3" readonly></textarea></div>
        <div><label for="campaignAuthor">Author:</label><input type="text" id="campaignAuthor" readonly></div>
        <div><label for="entryMap">Entry Map:</label><input type="text" id="entryMap" readonly><button type="button" class="browse-button" data-target-input="entryMap">Browse...</button></div>
        <h4>Data File Paths:</h4><ul id="filePathsList"></ul>
    </div>

    <div id="npcSection">
        <h2>NPCs</h2>
        <div id="npcManagementSection">
            <label for="searchNpcInput">Search NPCs:</label><input type="text" id="searchNpcInput" class="search-input" placeholder="Search by ID or Name..."><br>
            <button id="showCreateNpcFormButton" class="button-primary">Create New NPC</button>
        </div>
        <div id="createNpcForm" style="display:none;">
            <h3>Create New NPC</h3>
            <div><label for="createNpcId">ID:</label><input type="text" id="createNpcId" name="createNpcId"></div>
            <div style="margin-top: 5px;"><label for="createNpcName">Name:</label><input type="text" id="createNpcName" name="createNpcName"></div>
            <div style="margin-top: 10px;"><button id="saveNewNpcButton" class="button-primary">Save NPC</button><button id="cancelCreateNpcButton">Cancel</button></div>
        </div>
        <ul id="npcList" style="margin-top: 10px;"></ul>
        <div id="editNpcForm" style="display:none;">
            <h3>Edit NPC</h3><input type="hidden" id="editingNpcOriginalId">
            <div><label for="editNpcId">ID (Read-only):</label><input type="text" id="editNpcId" name="editNpcId" readonly></div>
            <div style="margin-top: 5px;"><label for="editNpcName">Name:</label><input type="text" id="editNpcName" name="editNpcName"></div>
            <div style="margin-top: 5px;"><label for="editNpcTemplateId">Template ID (Read-only):</label><input type="text" id="editNpcTemplateId" name="editNpcTemplateId" readonly></div>
            <div style="margin-top: 10px;"><button id="saveNpcChangesButton" class="button-primary">Save Changes</button><button id="duplicateNpcButton" class="button-primary">Duplicate NPC</button><button id="deleteNpcButton" class="button-danger">Delete NPC</button><button id="cancelEditNpcButton">Cancel</button></div>
        </div>
    </div>

    <div id="dialogueSection">
        <h2>Dialogues</h2>
        <div id="dialogueManagementSection">
            <label for="dialogueDirectoryDisplay">Dialogue Directory:</label><input type="text" id="dialogueDirectoryDisplay" readonly style="margin-bottom: 5px;"><br>
            <button id="refreshDialogueListButton">Refresh Dialogue List</button>
            <button id="showCreateDialogueFileFormButton" class="button-primary">Create New Dialogue File</button>
            <div id="createDialogueFileForm" style="display:none;">
                <h4>Create New Dialogue File</h4>
                <div><label for="newDialogueFileName">File Name (e.g., my_dialogue.json):</label><br><input type="text" id="newDialogueFileName" name="newDialogueFileName"></div>
                <div style="margin-top: 5px;"><label for="newDialogueId">Dialogue ID (e.g., my_dialogue_id):</label><br><input type="text" id="newDialogueId" name="newDialogueId"></div>
                <div style="margin-top: 10px;"><button id="saveNewDialogueFileButton" class="button-primary">Save New File</button><button id="cancelCreateDialogueFileButton">Cancel</button></div>
            </div>
            <h3 style="margin-top: 10px; margin-bottom: 5px;">Dialogue Files:</h3>
            <label for="searchDialogueFilesInput">Search Dialogue Files:</label><input type="text" id="searchDialogueFilesInput" class="search-input" placeholder="Search by file name..."><br>
            <ul id="dialogueFilesList"></ul>
            <div id="dialogueEditorSection" style="display:none;">
                <h4>Dialogue Editor</h4>
                <p><strong>Editing File:</strong> <span id="editingDialogueFileName"></span></p>
                <div><label for="dialogueMetaId">Dialogue ID:</label><input type="text" id="dialogueMetaId" name="dialogueMetaId"></div>
                <div style="margin-top: 5px;"><label for="dialogueMetaStartingNode">Starting Node:</label><input type="text" id="dialogueMetaStartingNode" name="dialogueMetaStartingNode"></div>
                <button id="saveDialogueChangesButton" class="button-primary" style="margin-top: 10px;">Save Dialogue Changes</button>
                <hr>
                <button type="button" id="toggleVisualDialogueEditorButton" style="margin-top: 5px; margin-bottom: 10px;">
                    Toggle Visual Editor Mockup
                </button>
                <div id="visualDialogueEditorPlaceholder">
                    <p style="color: #007bff; font-size: 1.2em;">
                        --- Visual Dialogue Editor Area (Conceptual Mockup) ---
                    </p>
                    <p>This is where a future visual, node-based dialogue editor would appear.</p>
                    <p>Nodes would be draggable boxes, and choices would be connection lines.</p>
                </div>

                <div id="textualDialogueEditorControls">
                    <h5>Nodes:</h5>
                    <label for="searchDialogueNodesInput">Search Nodes:</label><input type="text" id="searchDialogueNodesInput" class="search-input" placeholder="Search by Node ID or NPC Line..."><br>
                    <ul id="dialogueNodesList"> </ul>
                    <button id="addNewDialogueNodeButton" type="button" class="button-primary" style="margin-top: 5px;">Add New Dialogue Node</button>

                    <div id="dialogueNodeEditArea" style="display:none;">
                        <h4>Edit Node: <span id="editingNodeIdDisplay" style="font-weight:normal;"></span></h4>
                        <label for="nodeNpcLine">NPC Line:</label><br><textarea id="nodeNpcLine" rows="3" style="margin-bottom:10px;"></textarea><br>

                        <h5>Player Choices:</h5><ul id="nodePlayerChoicesList"></ul>
                        <button id="addNewChoiceToNodeButton" type="button" class="button-primary" style="margin-top:5px;">Add New Choice</button><br><br>

                        <button id="deleteCurrentNodeButton" type="button" class="button-danger" style="margin-top:15px;">Delete Current Node</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="questSection">
        <h2>Quests</h2>
        <div id="questManagementSection">
            <label for="questsFileDisplay">Quests File Path:</label><input type="text" id="questsFileDisplay" readonly style="margin-bottom: 5px;"><br>
            <button id="showCreateQuestFormButton" class="button-primary" style="margin-bottom: 10px;">Create New Quest</button>
            <div id="createQuestForm" style="display:none;">
                <h4>Create New Quest</h4>
                <div><label for="newQuestId">Quest ID:</label><br><input type="text" id="newQuestId" name="newQuestId"></div>
                <div style="margin-top: 5px;"><label for="newQuestTitle">Title:</label><br><input type="text" id="newQuestTitle" name="newQuestTitle"></div>
                <div style="margin-top: 5px;"><label for="newQuestDescription">Description:</label><br><textarea id="newQuestDescription" name="newQuestDescription" rows="3"></textarea></div>
                <div style="margin-top: 10px;"><button id="saveNewQuestButton" class="button-primary">Save New Quest</button><button id="cancelCreateQuestButton">Cancel</button></div>
            </div>
            <h3 style="margin-top: 10px; margin-bottom: 5px;">Quests:</h3>
            <label for="searchQuestsInput">Search Quests:</label><input type="text" id="searchQuestsInput" class="search-input" placeholder="Search by ID or Title..."><br>
            <ul id="questsList"></ul>
            <div id="editQuestForm" style="display:none;">
                <h4>Edit Quest</h4><input type="hidden" id="editingQuestOriginalId">
                <div><label for="editQuestId">Quest ID (Read-only):</label><br><input type="text" id="editQuestId" name="editQuestId" readonly></div>
                <div style="margin-top: 5px;"><label for="editQuestTitle">Title:</label><br><input type="text" id="editQuestTitle" name="editQuestTitle"></div>
                <div style="margin-top: 5px;"><label for="editQuestDescription">Description:</label><br><textarea id="editQuestDescription" name="editQuestDescription" rows="3"></textarea></div>
                <div style="margin-top: 10px;"><button id="saveQuestChangesButton" class="button-primary">Save Quest Changes</button><button id="deleteQuestButton" class="button-danger">Delete Quest</button><button id="cancelEditQuestButton">Cancel</button></div>
                <div id="questObjectivesSection" style="margin-top:15px;">
                    <h5>Objectives:</h5>
                    <ul id="questObjectivesList" style="list-style-type: none; padding-left: 0; margin-bottom: 10px;">
                        <!-- Editable objective rows will be rendered here by JS -->
                    </ul>
                    <button type="button" id="addNewQuestObjectiveRowButton" class="button-primary" style="margin-top:10px;">Add New Objective</button>
                </div>
            </div>
        </div>
    </div>

    <div id="zoneSection">
        <h2>Game Zones</h2>
        <div id="zoneManagementSection">
            <label for="zonesFileDisplay">Zones File Path:</label><input type="text" id="zonesFileDisplay" readonly style="margin-bottom: 5px;"><br>
            <button id="showCreateZoneFormButton" class="button-primary" style="margin-bottom: 10px;">Create New Zone</button>
            <h3 style="margin-top: 10px; margin-bottom: 5px;">Zones:</h3>
            <label for="searchZonesInput">Search Zones:</label><input type="text" id="searchZonesInput" class="search-input" placeholder="Search by ID or Name..."><br>
            <ul id="zonesList"></ul>
        </div>
        <div id="createZoneForm" style="display:none;">
            <h4>Create New Zone</h4>
            <div><label for="newZoneId">Zone ID:</label><br><input type="text" id="newZoneId" name="newZoneId"></div>
            <div style="margin-top: 5px;"><label for="newZoneName">Name:</label><br><input type="text" id="newZoneName" name="newZoneName"></div>
            <div style="margin-top: 5px;"><label for="newZoneMapFilePath">Map File Path:</label><input type="text" id="newZoneMapFilePath" name="newZoneMapFilePath" placeholder="e.g., maps/my_awesome_map.json"><button type="button" class="browse-button" data-target-input="newZoneMapFilePath">Browse...</button><br></div>
            <div style="margin-top: 10px;"><button id="saveNewZoneButton" class="button-primary">Save New Zone</button><button id="cancelCreateZoneButton">Cancel</button></div>
        </div>
        <div id="editZoneForm" style="display:none;">
            <h4>Edit Zone</h4><input type="hidden" id="editingZoneOriginalId">
            <div><label for="editZoneId">Zone ID (Read-only):</label><br><input type="text" id="editZoneId" name="editZoneId" readonly></div>
            <div style="margin-top: 5px;"><label for="editZoneName">Name:</label><br><input type="text" id="editZoneName" name="editZoneName"></div>
            <div style="margin-top: 5px;"><label for="editZoneMapFilePath">Map File Path:</label><input type="text" id="editZoneMapFilePath" name="editZoneMapFilePath"><button type="button" class="browse-button" data-target-input="editZoneMapFilePath">Browse...</button><br></div>
            <div style="margin-top: 10px;"><button id="saveZoneChangesButton" class="button-primary">Save Zone Changes</button><button id="deleteZoneButton" class="button-danger">Delete Zone</button><button id="cancelEditZoneButton">Cancel</button></div>
        </div>
    </div>

    <div id="worldMapSection">
        <h2>World Map Nodes</h2>
        <div id="worldMapManagementSection">
            <label for="worldMapFileDisplay">World Map File Path:</label><input type="text" id="worldMapFileDisplay" readonly style="margin-bottom: 5px;"><br>
            <button id="showCreateWorldMapNodeFormButton" class="button-primary" style="margin-bottom: 10px;">Create New Map Node</button>
            <h3 style="margin-top: 10px; margin-bottom: 5px;">Map Nodes:</h3>
            <label for="searchWorldMapNodesInput">Search Map Nodes:</label><input type="text" id="searchWorldMapNodesInput" class="search-input" placeholder="Search by ID or Name..."><br>
            <ul id="worldMapNodesList"></ul>
        </div>
        <div id="createWorldMapNodeForm" style="display:none;">
            <h4>Create New World Map Node</h4>
            <div><label for="newWorldMapNodeId">Node ID:</label><br><input type="text" id="newWorldMapNodeId" name="newWorldMapNodeId"></div>
            <div style="margin-top: 5px;"><label for="newWorldMapNodeName">Name:</label><br><input type="text" id="newWorldMapNodeName" name="newWorldMapNodeName"></div>
            <div style="margin-top: 5px;"><label for="newWorldMapNodeZoneId">Zone ID (Optional, links to a Game Zone):</label><br><input type="text" id="newWorldMapNodeZoneId" name="newWorldMapNodeZoneId" placeholder="e.g., zone_fallbrook_center"></div>
            <div style="margin-top: 10px;"><button id="saveNewWorldMapNodeButton" class="button-primary">Save New Node</button><button id="cancelCreateWorldMapNodeButton">Cancel</button></div>
        </div>
        <div id="editWorldMapNodeForm" style="display:none;">
            <h4>Edit World Map Node</h4><input type="hidden" id="editingWorldMapNodeOriginalId">
            <div><label for="editWorldMapNodeId">Node ID (Read-only):</label><br><input type="text" id="editWorldMapNodeId" name="editWorldMapNodeId" readonly></div>
            <div style="margin-top: 5px;"><label for="editWorldMapNodeName">Name:</label><br><input type="text" id="editWorldMapNodeName" name="editWorldMapNodeName"></div>
            <div style="margin-top: 5px;"><label for="editWorldMapNodeZoneId">Zone ID (Optional):</label><br><input type="text" id="editWorldMapNodeZoneId" name="editWorldMapNodeZoneId"></div>
            <div style="margin-top: 10px;"><button id="saveWorldMapNodeChangesButton" class="button-primary">Save Node Changes</button><button id="deleteWorldMapNodeButton" class="button-danger">Delete Node</button><button id="cancelEditWorldMapNodeButton">Cancel</button></div>
        </div>
    </div>

    <div id="scheduleSection">
        <h2>NPC Schedules</h2>
        <div id="scheduleManagementSection">
            <label for="schedulesFileDisplay">Schedules File Path:</label><input type="text" id="schedulesFileDisplay" readonly style="margin-bottom: 5px;"><br>
            <h4>Available Schedule IDs:</h4>
            <label for="searchScheduleIdsInput">Search Schedule IDs:</label><input type="text" id="searchScheduleIdsInput" class="search-input" placeholder="Search by ID..." style="width: 50%;"><br>
            <ul id="scheduleIdsList"></ul>
            <button id="showCreateScheduleIdFormButton" class="button-primary">Create New Schedule ID</button>
            <div id="createScheduleIdForm" style="display:none;">
                <label for="newScheduleIdName">New Schedule ID:</label><input type="text" id="newScheduleIdName">
                <button id="saveNewScheduleIdButton" class="button-primary">Save ID</button><button id="cancelCreateScheduleIdButton">Cancel</button>
            </div>
        </div>
        <div id="editScheduleEntriesForm" style="display:none;">
            <h4>Edit Entries for Schedule: <span id="editingScheduleIdName" style="font-weight:bold;"></span></h4>
            <ul id="scheduleEntriesList" style="margin-bottom:15px;"></ul>
            <div id="addScheduleEntryForm">
                <h5>Add New Schedule Entry</h5>
                <div><label for="entryTime">Time (e.g., 08:00):</label><br><input type="text" id="entryTime"></div>
                <div style="margin-top:5px;"><label for="entryAction">Action:</label><br><input type="text" id="entryAction"></div>
                <div style="margin-top:5px;"><label for="entryMapId">Map ID:</label><br><input type="text" id="entryMapId"></div>
                <div style="margin-top:5px;"><label for="entryWaypointId">Waypoint ID:</label><br><input type="text" id="entryWaypointId"></div>
                <button type="button" id="addScheduleEntryButton" class="button-primary" style="margin-top:10px;">Add Entry</button>
            </div>
            <hr><button id="saveScheduleChangesButton" class="button-primary">Save All Schedule Changes</button>
            <button id="closeScheduleEditorButton" style="margin-left:10px;">Close Editor</button>
        </div>
    </div>

    <div id="randomEncounterSection">
        <h2>Random Encounters</h2>
        <div id="randomEncounterManagementSection">
            <label for="randomEncountersFileDisplay">Encounters File Path:</label><input type="text" id="randomEncountersFileDisplay" readonly style="margin-bottom: 5px;"><br>
            <button id="showCreateRandomEncounterFormButton" class="button-primary" style="margin-bottom: 10px;">Create New Encounter Group</button>
            <h3 style="margin-top: 10px; margin-bottom: 5px;">Encounter Groups:</h3>
            <label for="searchRandomEncountersInput">Search Encounter Groups:</label><input type="text" id="searchRandomEncountersInput" class="search-input" placeholder="Search by ID or Description..." style="width: 50%;"><br>
            <ul id="randomEncountersList"></ul>
        </div>
        <div id="createRandomEncounterForm" style="display:none;">
            <h4>Create New Encounter Group</h4>
            <div><label for="newEncounterId">Group ID:</label><br><input type="text" id="newEncounterId" name="newEncounterId"></div>
            <div style="margin-top: 5px;"><label for="newEncounterDescription">Description:</label><br><input type="text" id="newEncounterDescription" name="newEncounterDescription"></div>
            <div style="margin-top: 5px;"><label for="newEncounterProbability">Probability (0.0-1.0):</label><br><input type="number" id="newEncounterProbability" name="newEncounterProbability" step="0.01" min="0" max="1"></div>
            <div style="margin-top: 5px;"><label for="newEncounterNpcIds">NPC IDs (comma-separated):</label><br><input type="text" id="newEncounterNpcIds" name="newEncounterNpcIds" placeholder="e.g., npc1,npc2,npc_raider"></div>
            <div style="margin-top: 10px;"><button id="saveNewRandomEncounterButton" class="button-primary">Save New Group</button><button id="cancelCreateRandomEncounterButton">Cancel</button></div>
        </div>
        <div id="editRandomEncounterForm" style="display:none;">
            <h4>Edit Encounter Group</h4><input type="hidden" id="editingRandomEncounterOriginalId">
            <div><label for="editEncounterId">Group ID (Read-only):</label><br><input type="text" id="editEncounterId" name="editEncounterId" readonly></div>
            <div style="margin-top: 5px;"><label for="editEncounterDescription">Description:</label><br><input type="text" id="editEncounterDescription" name="editEncounterDescription"></div>
            <div style="margin-top: 5px;"><label for="editEncounterProbability">Probability (0.0-1.0):</label><br><input type="number" id="editEncounterProbability" name="editEncounterProbability" step="0.01" min="0" max="1"></div>
            <div style="margin-top: 5px;"><label for="editEncounterNpcIds">NPC IDs (comma-separated):</label><br><input type="text" id="editEncounterNpcIds" name="editEncounterNpcIds"></div>
            <div style="margin-top: 10px;"><button id="saveRandomEncounterChangesButton" class="button-primary">Save Group Changes</button><button id="deleteRandomEncounterButton" class="button-danger">Delete Group</button><button id="cancelEditRandomEncounterButton">Cancel</button></div>
        </div>
    </div>

    <div id="storyBeatSection">
        <h2>Story Beats</h2>
        <div id="storyBeatManagementSection">
            <label for="storyBeatsFileDisplay">Story Beats File Path:</label><input type="text" id="storyBeatsFileDisplay" readonly style="margin-bottom: 5px;"><br>
            <label for="searchStoryBeatsInput">Search Story Beats:</label><input type="text" id="searchStoryBeatsInput" class="search-input" placeholder="Search by Beat ID..." style="width: 50%;"><br>
            <table id="storyBeatsTable" border="1">
                <thead><tr><th>Beat ID (Key)</th><th>Value</th><th>Actions</th></tr></thead>
                <tbody id="storyBeatsTableBody"></tbody>
            </table>
            <button id="saveAllStoryBeatChangesButton" class="button-primary" style="margin-top:10px;">Save All Story Beat Changes</button>
            <button id="showCreateStoryBeatFormButton" class="button-primary" style="margin-top:10px;">Add New Story Beat</button>
        </div>
        <div id="createStoryBeatForm" style="display:none;">
            <h4>Add New Story Beat</h4>
            <div><label for="newStoryBeatId">Beat ID (Key):</label><br><input type="text" id="newStoryBeatId" name="newStoryBeatId"></div>
            <div style="margin-top: 5px;"><label for="newStoryBeatValue">Initial Value (true/false or text):</label><br><input type="text" id="newStoryBeatValue" name="newStoryBeatValue" value="false"></div>
            <div style="margin-top: 10px;"><button id="saveNewStoryBeatButton" class="button-primary">Save New Beat</button><button id="cancelCreateStoryBeatButton">Cancel</button></div>
        </div>
    </div>

    <div id="errorMessages" style="color: red;"></div>

    <script src="app.js"></script>
    <script>
        if (!navigator.onLine) {
            const errorDiv = document.getElementById('errorMessages');
            if (errorDiv) errorDiv.textContent = "Warning: No internet connection detected. Some features might be unavailable.";
        }
    </script>
</body>
</html>

[end of campaign-designer/frontend/index.html]
